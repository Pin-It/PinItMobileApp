language: android
jdk: oraclejdk8
env:
  global:
  - secure: DA+uf8y39sUqG1mL4JHXoxy0yzJtzqKtvDPiPlSxMHm8BXvKNuqXffFo+wggeC7eV+DPXFhKKNysGrCJXAfA2xvEfUKtuuTyAuPfNUWs0AHIBa3ufcKT/Q6lcSX+hgUZdSc3EHiTMNnyKMTT0q6rfpKxuduz/IXnzidkNnLt4GYs/yZA10z/Ol7BIZct2vAQASEYaZZHY1WynDCMOpIo5Ja5p3TxVKm0d7qxSY+lSe1iC+ny3+iQq13wZt1SThrq9zwRN89M8cvaLRa+nt23mngOmgbeuTA/VL4RcJFSn0TY53QhtELlNJrpYIIhNxVWTMIFMJ0MPMA9E1az+e9QgmK9Hb4OPTMkLMNbd5Jr2aF/pBdPCjMeQwWtUIF3Cgi1oi8K8XypuhJ8TgmGIPEyQRyRZq38LRuTqH7w81ZPaWDG/OQ0A9ELCA3+dc8/P3fiXxOvZgivhV7+2j+OvkL00MCPhkTFxwtGl53EnQkaJ/9yHRoC17FqXQ7oEa7At9NcwnuT/PaXu8AafiNjMOKx7zSRrvfWIf5MwKkUsYIDUyaNM4EPAj7YDzw9NJ2rCmMlcC2HkAbHeVDNdQtSGuP3+1e1YXkP0T2E71cFa3uPBEKSZwdWtOpG7YcFfoRQ+WhVnk0IVYZiPQaOOEX4Yai65wBj5oUDavhCgi5yYJG0TuA=
  - secure: A7lT19C4FX3gp7OnAonR0PtKMuIFJBnFXxNfH9CLn5Z0WqArCI6Jln+2u9FWDAYoDlmwcvf6TLzLSkDkRckeE1Iygyn3GJwySji+Gzq2nBm48IQt7JqT+SqW10QBj7s+YjzUbb/kzYzXahJNq6QLjz3WL/eERaWiWgfIY36Qsa2s0miB7z1yrXkp1iMQVQY06TkVNm9IypAoDq53ep0IR8zXDznezEkTBOucAg1z9EjYjZB6uRN8zWNHfY3MmmAdPNXI+jviGiCv/mkhbhwaKz5Ru83JEhUoHdX9mMr19p4A5uO57t6CLCNd8zaZm43Md0RuntTaL5+j8Ej8draRFyFZ/M0pb79OXQybQVOx5CUTfQboiWYoQwaNtvIuCGBN0O6Fe/nnHpriGerHn9aj2HKSF49EZFqyWpl57rvejMgB/oB6LlHssL3CLm0C4mWss9a5/aS4lAv8sVjfUMoAdg72s3fpWa2hG3Zg6pwSKcdMs7vOrnmNgFw0EirtD2Tx/SMykWNukI/Fv3I2YsqpZBQ75C25nWPBOJ9WtqmS1klnIKU76Vjx3YmdTz/7xqUgoP/ThfWOwm7TsVxtFKSS9VPNn31Ao7+YJYFEMXdtm9c3ScFFk5J4aTL3zz1JGVAlM0E5kCElfUd3FJpx2Im4fIl2QhUtbV31/SQqlKD/UnI=
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -rf $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
  - "$HOME/.android/build-cache"
android:
  components:
  - tools
  - platform-tools
  - tools
  - build-tools-27.0.3
  - android-27
  - extra-google-google_play_services
  - extra-google-m2repository
  - extra-android-m2repository
  - extra-android-support
  - addon-google_apis-google-27
  licenses:
  - android-sdk-preview-.+
  - android-sdk-license-.+
  - google-gdk-license-.+
script:
- "./gradlew build check"
- "./gradlew test"
deploy:
  provider: releases
  api_key: "$GITHUB_KEY"
  file_glob: true
  file: app/build/outputs/apk/release/PinItAndroid.apk
  overwrite: true
  skip_cleanup: true
  on:
    repo: Pin-It/PinItMobileApp
    branch: master
    tags: true
before_install:
- openssl enc -aes-256-cbc -d -in keystore.jks.enc -out keystore.jks -base64 -K $TRAVIS_KEY
  -iv $TRAVIS_IV
